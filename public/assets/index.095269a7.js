var j=Object.defineProperty,G=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var O=(e,t,o)=>t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,_=(e,t)=>{for(var o in t||(t={}))Y.call(t,o)&&O(e,o,t[o]);if(B)for(var o of B(t))K.call(t,o)&&O(e,o,t[o]);return e},k=(e,t)=>G(e,z(t));import{c,o as d,a as J,b as m,l as Q,m as M,d as U,e as p,f as a,t as i,F as S,r as b,w as y,v as T,g as $,h as g,n as E,i as C,p as L,j as V,k as W,q as N,s as P,u as R,x as X,y as Z}from"./vendor.0793f3cc.js";const ee=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}};ee();var f=(e,t)=>{const o=e.__vccOpts||e;for(const[n,s]of t)o[n]=s;return o};const te={},se={class:"close-icon"};function oe(e,t,o,n,s,r){return d(),c("div",se)}var q=f(te,[["render",oe],["__scopeId","data-v-2eb9cc04"]]);const ae="http://houseweb.herokuapp.com/";var x={host:ae},D=J({state:{schedule:{},username:"",messages:null,chatUsername:null,showMessages:!1,showSchedule:!1},getters:{getSchedule:e=>e.schedule,getScheduleById:e=>t=>{let o=null;return Object.entries(e.schedule).forEach(([n,s])=>{s.forEach(r=>{r._id===t&&(o=r)})}),o},getUsername:e=>e.username,getMessages:e=>e.messages,getChatUsername:e=>e.chatUsername,getShowMessages:e=>e.showMessages,getShowSchedule:e=>e.showSchedule},actions:{async fetchSchedule({commit:e}){try{const t=await m.get(`${x.host}api/schedule`);e("addSchedule",t.data)}catch(t){console.log(t.message)}},async addToSchedule({commit:e},t){try{t.date.setHours(0,0,0,0);const o=k(_({},t),{username:this.state.username}),n=await m.post(`${x.host}api/schedule`,o);e("addToSchedule",n.data)}catch(o){console.log("addToSchedule Error -> "+o)}},async editNote({commit:e},t){try{const o=await m.put(`${x.host}api/schedule`,t)}catch(o){console.log("editSchedule Error -> "+o)}},async deleteFromSchedule({commit:e},t){if(confirm("are you shure?"))try{const o=await m.delete(`${x.host}api/schedule/${t}`);e("deleteFromSchedule",t)}catch(o){console.log(`deleteFromSchedule error -> ${o}`)}},async login({commit:e,dispatch:t},o){try{const n=await m.post(`${x.host}api/auth`,o);console.log(`user ${n.data.username} is logged in`);const s=n.headers["x-auth-token"];localStorage.setItem("x-auth-token",s),localStorage.setItem("username",n.data.username),m.defaults.headers.post["x-auth-token"]=s,m.defaults.headers.delete["x-auth-token"]=s,m.defaults.headers.put["x-auth-token"]=s,e("setUsername",n.data.username),w.auth.token=s,w.connect()}catch(n){if(n.request!=null)throw n;console.log(n)}},logout({commit:e}){e("setUsername",""),e("addMessages",null),e("setShowMessages",!1),e("setChatUsername",null),localStorage.removeItem("x-auth-token"),delete m.defaults.headers.post["x-auth-token"],delete m.defaults.headers.delete["x-auth-token"],w.auth.token=null,w.close()}},mutations:{addSchedule(e,t){const o=(n,s)=>n.reduce((r,l)=>k(_({},r),{[l[s]]:[...r[l[s]]||[],l]}),{});e.schedule=o(t,"date")},addToSchedule(e,t){Object.keys(e.schedule).includes(t.date)?e.schedule[t.date].push(t):e.schedule[t.date]=[t]},setUsername(e,t){e.username=t},editSchedule(e,t){let o=this.getScheduleById(t.id);o.text=t.tex},deleteFromSchedule(e,t){Object.entries(e.schedule).forEach(([o,n])=>{n.forEach(s=>{s._id===t&&(e.schedule[o].splice(n.indexOf(s),1),e.schedule[o].length===0&&delete e.schedule[o])})})},addMessages(e,t){e.messages=t},addMessage(e,t){t.from===e.username?e.messages[t.to]?e.messages[t.to].push(t):e.messages[t.to]=[t]:e.messages[t.from]?e.messages[t.from].push(t):e.messages[t.from]=[t]},setChatUsername(e,t){e.chatUsername=t,e.chatUsername!=null&&(e.showSchedule=!1)},setShowMessages(e,t){e.showMessages=t,e.showMessages==!0&&(e.showSchedule=!1)},setShowSchedule(e,t){e.showSchedule=t,e.showSchedule==!0&&(e.showMessages=!1,e.chatUsername=null)}}});const ne=(e,t)=>{const o={};return e.map(n=>{n.from!=t?o[n.from]=[...o[n.from]||[],n]:o[n.to]=[...o[n.to]||[],n]}),o},w=Q(x.host,{auth:{token:localStorage.getItem("x-auth-token")}});w.on("connect_error",e=>{console.log(e.message)});w.on("messages",e=>{D.commit("addMessages",ne(e,D.state.username))});w.on("message",e=>{D.commit("addMessage",e)});const re={data(){return{messageText:""}},components:{CloseIcon:q},computed:_({},M(["getMessages","getUsername","getChatUsername"])),methods:k(_({},U(["setChatUsername"])),{sendMessage(){w.emit("postMessage",{to:this.getChatUsername,text:this.messageText}),this.messageText=""}})},le={key:0,class:"chat-container"},ce={class:"username"},de={class:"chat"},ie={class:"chat-messages"},ue={class:"chat-input-form"};function he(e,t,o,n,s,r){const l=g("close-icon");return e.getChatUsername?(d(),c("div",le,[p(l,{onClick:t[0]||(t[0]=h=>e.setChatUsername(null))}),a("div",ce,i(e.getChatUsername),1),a("div",de,[(d(!0),c(S,null,b(e.getMessages[e.getChatUsername],h=>(d(),c("div",ie,[a("div",{class:E(["chat-message",h.from===e.getUsername?"chat-message-left":"chat-message-right"])},i(h.text),3)]))),256))]),a("div",ue,[y(a("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=h=>s.messageText=h)},null,512),[[T,s.messageText]]),a("button",{onClick:t[2]||(t[2]=(...h)=>r.sendMessage&&r.sendMessage(...h))},"send")])])):$("",!0)}var _e=f(re,[["render",he],["__scopeId","data-v-2f0343f6"]]);const me={name:"Forecast",props:{forecast:Array},methods:{calcTemp(e){return Math.round(Number(e)-273.15)}}},pe=e=>(L("data-v-16a9242c"),e=e(),V(),e),ge={class:"forecast"},fe=C(" \xA0 5 day forecast "),ve=pe(()=>a("hr",null,null,-1)),we={key:"day.dt"},Se={key:"day.dt"},ye={key:"day.dt"};function $e(e,t,o,n,s,r){return d(),c("div",ge,[fe,ve,a("table",null,[a("tr",null,[(d(!0),c(S,null,b(o.forecast,l=>(d(),c("th",we,i(l.day),1))),128))]),a("tr",null,[(d(!0),c(S,null,b(o.forecast,l=>(d(),c("td",Se,i(r.calcTemp(l.main.temp)),1))),128))]),a("tr",null,[(d(!0),c(S,null,b(o.forecast,l=>(d(),c("td",ye,i(l.weather[0].main),1))),128))])])])}var ke=f(me,[["render",$e],["__scopeId","data-v-16a9242c"]]);const be={name:"WeatherCard",components:{Forecast:ke},data(){return{weather:{},showForecast:!1}},methods:{calcTemp(e){return Math.round(Number(e)-273.15)},calcWindSpeed(e){return Math.round(e*3.6*10)/10},getIconUrl(e){return`http://openweathermap.org/img/w/${e}.png`},calcWindDirection(e){var t=Math.floor(e/22.5+.5),o=["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"];return o[t%16]},toggleShowForecast(){this.weather.forecast||this.fetchForecast().catch(e=>console.log(e)),this.showForecast=!this.showForecast},async fetchWeather(){try{const e=await m.get("https://api.openweathermap.org/data/2.5/weather/?q=gudovac&appid=524464013431281f7aabe3e488765d52");this.weather=await e.data}catch(e){console.log(e)}},async fetchForecast(){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=[];try{const n=await(await m.get("https://api.openweathermap.org/data/2.5/forecast/?q=gudovac&appid=524464013431281f7aabe3e488765d52")).data;if(typeof n!="undefined"){for(let s=7;s<=n.list.length;s+=8){let r=new Date(n.list[s].dt_txt);n.list[s].day=e[r.getDay()],t.push(n.list[s])}this.weather.forecast=t}else throw"problem with fetching forecast"}catch(o){console.log(o)}}},created(){this.fetchWeather()}},F=e=>(L("data-v-382b080d"),e=e(),V(),e),Ce={key:0,class:"card"},xe={class:"header-left"},Ie={class:"header-right"},Me=["src"],Ue=F(()=>a("div",{style:{clear:"both"}},null,-1)),Fe={class:"weather-main"},Te={class:"main-temp"},Ee={class:"main-right"},We=F(()=>a("br",null,null,-1)),Ne=F(()=>a("br",null,null,-1)),De=F(()=>a("br",null,null,-1)),Le=F(()=>a("div",{style:{clear:"both"}},null,-1));function Ve(e,t,o,n,s,r){const l=g("forecast");return s.weather.name?(d(),c("div",Ce,[a("div",xe,[a("b",null,i(s.weather.name),1),C(" , "+i(s.weather.weather[0].description),1)]),a("div",Ie,[a("img",{src:r.getIconUrl(s.weather.weather[0].icon),alt:""},null,8,Me)]),Ue,a("div",Fe,[a("div",Te,i(r.calcTemp(s.weather.main.temp))+"\xB0",1),a("div",Ee,[C(" Feels Like: "+i(r.calcTemp(s.weather.main.feels_like))+" \xB0C ",1),We,C(" Pressure:"+i(s.weather.main.pressure)+" hPa ",1),Ne,C(" Humidity: "+i(s.weather.main.humidity)+" % ",1),De,C(" Wind: "+i(r.calcWindSpeed(s.weather.wind.speed))+" km/h, "+i(r.calcWindDirection(s.weather.wind.deg)),1)])]),a("div",{class:"show-forecast-btn",onClick:t[0]||(t[0]=(...h)=>r.toggleShowForecast&&r.toggleShowForecast(...h))},[a("div",{class:E(s.showForecast?"forecast-icon-minus":"forecast-icon")},null,2)]),Le,y(p(l,{forecast:s.weather.forecast},null,8,["forecast"]),[[W,s.showForecast]])])):$("",!0)}var Be=f(be,[["render",Ve],["__scopeId","data-v-382b080d"]]);const Oe={props:{text:String}};function Pe(e,t,o,n,s,r){return d(),c("div",{class:"glow-on-hover",onClick:t[0]||(t[0]=l=>l.target.classList.toggle("active"))},i(o.text),1)}var A=f(Oe,[["render",Pe],["__scopeId","data-v-2dbac0e2"]]);const qe={name:"Schedule",components:{ButtonGlow:A},data(){return{show:!1,editableId:null,oldText:""}},computed:_({},M(["getSchedule","getUsername","getShowSchedule"])),methods:k(_(_({},N(["deleteFromSchedule","editNote"])),U(["setShowSchedule"])),{editInSchedule(e){const t=document.getElementById(e);t.contentEditable=!0,t.classList.add("note-text-edit"),this.editableId=e,this.oldText=t.innerHTML},save(e){const t=document.getElementById(e),o=t.innerHTML.replace(/\u00a0/g," ");t.contentEditable=!1,t.classList.remove("note-text-edit"),this.editableId=null,this.oldText="";try{this.editNote({id:e,text:o})}catch(n){console.log(n)}},cancel(e){const t=document.getElementById(e);t.innerHTML=this.oldText,t.contentEditable=!1,t.classList.remove("note-text-edit"),this.editableId=null,this.oldText=""}})},Ae={class:"schedule"},He={class:"day"},je={class:"day-date"},Ge={class:"note"},ze={class:"note-header"},Ye={class:"note-username"},Ke={class:"note-icons"},Je=["onClick"],Qe=["onClick"],Re=["onClick"],Xe=["onClick"],Ze=["id"];function et(e,t,o,n,s,r){const l=g("button-glow");return d(),c("div",Ae,[p(l,{text:e.getShowSchedule?"Hide Schedule":"Show Schedule",onClick:t[0]||(t[0]=h=>e.setShowSchedule(!e.getShowSchedule))},null,8,["text"]),a("div",{class:E(["notes",{"notes-show":e.getShowSchedule}])},[(d(!0),c(S,null,b(e.getSchedule,(h,v)=>(d(),c("div",He,[a("div",je,i(new Date(v).getDate())+". "+i(new Date(v).getMonth()+1)+". "+i(new Date(v).getFullYear())+". ",1),(d(!0),c(S,null,b(h,u=>(d(),c("div",Ge,[a("div",ze,[a("span",Ye,i(u.username)+" :",1),a("span",Ke,[e.getUsername===u.username&&s.editableId===u._id?(d(),c("i",{key:0,onClick:I=>r.save(u._id),class:"fa fa-save"},null,8,Je)):$("",!0),e.getUsername===u.username&&s.editableId===u._id?(d(),c("i",{key:1,onClick:I=>r.cancel(u._id),class:"fa fa-times"},null,8,Qe)):$("",!0),e.getUsername===u.username&&s.editableId!=u._id?(d(),c("i",{key:2,onClick:I=>r.editInSchedule(u._id),class:"fa fa-edit"},null,8,Re)):$("",!0),e.getUsername===u.username?(d(),c("i",{key:3,onClick:I=>e.deleteFromSchedule(u._id),class:"fa fa-trash"},null,8,Xe)):$("",!0)])]),a("span",{class:"note-text",id:u._id},i(u.text.replace(/ /g," ")),9,Ze)]))),256))]))),256))],2)])}var tt=f(qe,[["render",et],["__scopeId","data-v-788e4f27"]]);const st={data(){return{text:""}},props:{date:Date},methods:k(_({},N(["addToSchedule"])),{save(e){this.text!=""&&(this.addToSchedule({date:this.date,text:this.text}),this.text="",this.$emit("close-form"))}})},ot={class:"input"},at={action:""},nt={key:0,class:"form-date"};function rt(e,t,o,n,s,r){return d(),c("div",ot,[a("form",at,[o.date?(d(),c("div",nt,i(String(o.date.getDate()).padStart(2,"0"))+" "+i(String(o.date.getMonth()+1).padStart(2,"0"))+" "+i(o.date.getFullYear()),1)):$("",!0),y(a("textarea",{name:"form-text","onUpdate:modelValue":t[0]||(t[0]=l=>s.text=l),class:"form-text"},null,512),[[T,s.text]]),a("button",{class:"form-btn",onClick:t[1]||(t[1]=P(l=>r.save(),["prevent"]))},"Save"),a("button",{onClick:t[2]||(t[2]=P(l=>e.$emit("close-form"),["prevent"]))},"Close")])])}var lt=f(st,[["render",rt],["__scopeId","data-v-a7de75d8"]]);const ct={components:{DatePicker:R,ScheduleInputForm:lt,ButtonGlow:A},data(){return{date:null,showCalendar:!1}},computed:_({},M(["getUsername"])),watch:{showCalendar:function(e){e||(this.date=null)}}},dt={class:"calendar"};function it(e,t,o,n,s,r){const l=g("DatePicker",!0),h=g("button-glow"),v=g("ScheduleInputForm");return d(),c(S,null,[y(a("div",dt,[a("div",{class:E(["date-picker-container",{"date-picker-show":s.showCalendar}])},[p(l,{modelValue:s.date,"onUpdate:modelValue":t[0]||(t[0]=u=>s.date=u),class:"date-picker",color:"blue","is-dark":""},null,8,["modelValue"])],2),p(h,{onClick:t[1]||(t[1]=u=>s.showCalendar=!s.showCalendar),text:s.showCalendar?"Close Calendar":"Show Calendar"},null,8,["text"])],512),[[W,e.getUsername!=""]]),p(v,{date:s.date,style:X(s.date?"transform: scale(1)":"transform: scale(0)"),onCloseForm:t[2]||(t[2]=u=>s.date=null)},null,8,["date","style"])],64)}var ut=f(ct,[["render",it],["__scopeId","data-v-f9549be6"]]);const ht={name:"Login",data(){return{username:"",password:""}},computed:_({},M(["getUsername"])),methods:k(_(_({},N(["login","logout"])),U(["setShowMessages"])),{async loginForm(e){e.preventDefault();const t=document.getElementById("username"),o=document.getElementById("password");try{await this.login({username:this.username,password:this.password})}catch(n){t.setCustomValidity(n.request.response),t.reportValidity(),t.setCustomValidity(""),o.setCustomValidity("")}}})},_t=e=>(L("data-v-90b8bbb8"),e=e(),V(),e),mt={class:"login"},pt=_t(()=>a("button",{type:"submit"},"log in",-1)),gt={class:"user"};function ft(e,t,o,n,s,r){return d(),c("div",mt,[y(a("form",{onSubmit:t[2]||(t[2]=(...l)=>r.loginForm&&r.loginForm(...l))},[y(a("input",{type:"text",name:"username",id:"username",required:"","onUpdate:modelValue":t[0]||(t[0]=l=>s.username=l),placeholder:"username"},null,512),[[T,s.username]]),y(a("input",{type:"text",name:"password",id:"password",required:"","onUpdate:modelValue":t[1]||(t[1]=l=>s.password=l),placeholder:"password"},null,512),[[T,s.password]]),pt],544),[[W,e.getUsername===""]]),y(a("div",gt,[a("p",{onClick:t[3]||(t[3]=l=>e.setShowMessages(!0))},i(e.getUsername),1),a("button",{onClick:t[4]||(t[4]=(...l)=>e.logout&&e.logout(...l))},"Log Out")],512),[[W,e.getUsername!=""]])])}var vt=f(ht,[["render",ft],["__scopeId","data-v-90b8bbb8"]]);const wt={name:"Messages",components:{CloseIcon:q},data(){return{messageText:""}},computed:_({},M(["getMessages","getUsername","getShowMessages"])),methods:_({},U(["setChatUsername","setShowMessages"]))},St={key:0,class:"message-container"},yt=["onClick"];function $t(e,t,o,n,s,r){const l=g("close-icon");return e.getShowMessages?(d(),c("div",St,[p(l,{onClick:t[0]||(t[0]=h=>e.setShowMessages(!1))}),(d(!0),c(S,null,b(e.getMessages,(h,v)=>(d(),c("div",{class:"message",onClick:u=>e.setChatUsername(v)},[a("b",null,i(v)+":",1),C(" "+i(h[h.length-1].text),1)],8,yt))),256))])):$("",!0)}var kt=f(wt,[["render",$t],["__scopeId","data-v-420fbf6a"]]);const bt={components:{WeatherCard:Be,DatePicker:ut,Schedule:tt,Login:vt,Messages:kt,Chat:_e},methods:_(_({},N(["fetchSchedule"])),U(["setUsername"])),created(){this.fetchSchedule();const e=localStorage.getItem("x-auth-token"),t=localStorage.getItem("username");e&&t&&(this.setUsername(t),m.defaults.headers.post["x-auth-token"]=e,m.defaults.headers.delete["x-auth-token"]=e,m.defaults.headers.put["x-auth-token"]=e)}},Ct={class:"container"},xt={class:"showcase"},It={class:"datepicker-container"},Mt={class:"weather-container"},Ut=a("div",{class:"welcome"},[a("h1",null,"house web")],-1),Ft={class:"schedule-container"};function Tt(e,t,o,n,s,r){const l=g("login"),h=g("date-picker"),v=g("WeatherCard"),u=g("Schedule"),I=g("messages"),H=g("chat");return d(),c("div",Ct,[p(l),a("div",xt,[a("div",It,[p(h)]),a("div",Mt,[Ut,p(v)]),a("div",Ft,[p(u)])]),p(I),p(H)])}var Et=f(bt,[["render",Tt]]);Z(Et).use(D,w).mount("#app");
