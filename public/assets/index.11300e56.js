var O=Object.defineProperty,q=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var L=(e,t,o)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,_=(e,t)=>{for(var o in t||(t={}))A.call(t,o)&&L(e,o,t[o]);if(D)for(var o of D(t))H.call(t,o)&&L(e,o,t[o]);return e},S=(e,t)=>q(e,P(t));import{o as c,c as d,a,F as w,r as k,t as i,b as x,p as T,d as U,e as h,n as W,w as y,v as F,f as m,g as $,h as p,m as M,i as E,j as N,k as V,s as j,l as G,q as z,u as Y,x as K}from"./vendor.feddef56.js";const J=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=o(s);fetch(s.href,n)}};J();var g=(e,t)=>{const o=e.__vccOpts||e;for(const[r,s]of t)o[r]=s;return o};const Q={name:"Forecast",props:{forecast:Array},methods:{calcTemp(e){return Math.round(Number(e)-273.15)}}},R=e=>(T("data-v-16a9242c"),e=e(),U(),e),X={class:"forecast"},Z=x(" \xA0 5 day forecast "),ee=R(()=>a("hr",null,null,-1)),te={key:"day.dt"},se={key:"day.dt"},oe={key:"day.dt"};function ae(e,t,o,r,s,n){return c(),d("div",X,[Z,ee,a("table",null,[a("tr",null,[(c(!0),d(w,null,k(o.forecast,l=>(c(),d("th",te,i(l.day),1))),128))]),a("tr",null,[(c(!0),d(w,null,k(o.forecast,l=>(c(),d("td",se,i(n.calcTemp(l.main.temp)),1))),128))]),a("tr",null,[(c(!0),d(w,null,k(o.forecast,l=>(c(),d("td",oe,i(l.weather[0].main),1))),128))])])])}var ne=g(Q,[["render",ae],["__scopeId","data-v-16a9242c"]]);const re={name:"WeatherCard",components:{Forecast:ne},data(){return{weather:{},showForecast:!1}},methods:{calcTemp(e){return Math.round(Number(e)-273.15)},calcWindSpeed(e){return Math.round(e*3.6*10)/10},getIconUrl(e){return`http://openweathermap.org/img/w/${e}.png`},calcWindDirection(e){var t=Math.floor(e/22.5+.5),o=["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"];return o[t%16]},toggleShowForecast(){this.weather.forecast||this.fetchForecast().catch(e=>console.log(e)),this.showForecast=!this.showForecast},async fetchWeather(){try{const e=await h.get("https://api.openweathermap.org/data/2.5/weather/?q=gudovac&appid=524464013431281f7aabe3e488765d52");this.weather=await e.data}catch(e){console.log(e)}},async fetchForecast(){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=[];try{const r=await(await h.get("https://api.openweathermap.org/data/2.5/forecast/?q=gudovac&appid=524464013431281f7aabe3e488765d52")).data;if(typeof r!="undefined"){for(let s=7;s<=r.list.length;s+=8){let n=new Date(r.list[s].dt_txt);r.list[s].day=e[n.getDay()],t.push(r.list[s])}this.weather.forecast=t}else throw"problem with fetching forecast"}catch(o){console.log(o)}}},created(){this.fetchWeather()}},C=e=>(T("data-v-382b080d"),e=e(),U(),e),le={key:0,class:"card"},ce={class:"header-left"},de={class:"header-right"},ie=["src"],ue=C(()=>a("div",{style:{clear:"both"}},null,-1)),he={class:"weather-main"},_e={class:"main-temp"},me={class:"main-right"},pe=C(()=>a("br",null,null,-1)),ge=C(()=>a("br",null,null,-1)),fe=C(()=>a("br",null,null,-1)),ve=C(()=>a("div",{style:{clear:"both"}},null,-1));function we(e,t,o,r,s,n){const l=p("forecast");return s.weather.name?(c(),d("div",le,[a("div",ce,[a("b",null,i(s.weather.name),1),x(" , "+i(s.weather.weather[0].description),1)]),a("div",de,[a("img",{src:n.getIconUrl(s.weather.weather[0].icon),alt:""},null,8,ie)]),ue,a("div",he,[a("div",_e,i(n.calcTemp(s.weather.main.temp))+"\xB0",1),a("div",me,[x(" Feels Like: "+i(n.calcTemp(s.weather.main.feels_like))+" \xB0C ",1),pe,x(" Pressure:"+i(s.weather.main.pressure)+" hPa ",1),ge,x(" Humidity: "+i(s.weather.main.humidity)+" % ",1),fe,x(" Wind: "+i(n.calcWindSpeed(s.weather.wind.speed))+" km/h, "+i(n.calcWindDirection(s.weather.wind.deg)),1)])]),a("div",{class:"show-forecast-btn",onClick:t[0]||(t[0]=(...f)=>n.toggleShowForecast&&n.toggleShowForecast(...f))},[a("div",{class:W(s.showForecast?"forecast-icon-minus":"forecast-icon")},null,2)]),ve,y(m(l,{forecast:s.weather.forecast},null,8,["forecast"]),[[F,s.showForecast]])])):$("",!0)}var ye=g(re,[["render",we],["__scopeId","data-v-382b080d"]]);const Se={props:{text:String}};function ke(e,t,o,r,s,n){return c(),d("div",{class:"glow-on-hover",onClick:t[0]||(t[0]=l=>l.target.classList.toggle("active"))},i(o.text),1)}var B=g(Se,[["render",ke],["__scopeId","data-v-2dbac0e2"]]);const xe={name:"Schedule",components:{ButtonGlow:B},data(){return{show:!1,editableId:null,oldText:""}},computed:_({},M(["getSchedule","getUsername"])),methods:S(_({},E(["deleteFromSchedule","editNote"])),{editInSchedule(e){const t=document.getElementById(e);t.contentEditable=!0,t.classList.add("note-text-edit"),this.editableId=e,this.oldText=t.innerHTML},save(e){const t=document.getElementById(e),o=t.innerHTML.replace(/\u00a0/g," ");t.contentEditable=!1,t.classList.remove("note-text-edit"),this.editableId=null,this.oldText="";try{this.editNote({id:e,text:o})}catch(r){console.log(r)}},cancel(e){const t=document.getElementById(e);t.innerHTML=this.oldText,t.contentEditable=!1,t.classList.remove("note-text-edit"),this.editableId=null,this.oldText=""}})},$e={class:"schedule"},be={class:"day"},Ie={class:"day-date"},Ce={class:"note"},Fe={class:"note-header"},Me={class:"note-username"},Ee={class:"note-icons"},Te=["onClick"],Ue=["onClick"],We=["onClick"],Ne=["onClick"],De=["id"];function Le(e,t,o,r,s,n){const l=p("button-glow");return c(),d("div",$e,[m(l,{text:s.show?"Hide Schedule":"Show Schedule",onClick:t[0]||(t[0]=f=>s.show=!s.show)},null,8,["text"]),a("div",{class:W(["notes",{"notes-show":s.show}])},[(c(!0),d(w,null,k(e.getSchedule,(f,v)=>(c(),d("div",be,[a("div",Ie,i(new Date(v).getDate())+". "+i(new Date(v).getMonth()+1)+". "+i(new Date(v).getFullYear())+". ",1),(c(!0),d(w,null,k(f,u=>(c(),d("div",Ce,[a("div",Fe,[a("span",Me,i(u.username)+" :",1),a("span",Ee,[e.getUsername===u.username&&s.editableId===u._id?(c(),d("i",{key:0,onClick:I=>n.save(u._id),class:"fa fa-save"},null,8,Te)):$("",!0),e.getUsername===u.username&&s.editableId===u._id?(c(),d("i",{key:1,onClick:I=>n.cancel(u._id),class:"fa fa-times"},null,8,Ue)):$("",!0),e.getUsername===u.username&&s.editableId!=u._id?(c(),d("i",{key:2,onClick:I=>n.editInSchedule(u._id),class:"fa fa-edit"},null,8,We)):$("",!0),e.getUsername===u.username?(c(),d("i",{key:3,onClick:I=>e.deleteFromSchedule(u._id),class:"fa fa-trash"},null,8,Ne)):$("",!0)])]),a("span",{class:"note-text",id:u._id},i(u.text.replace(/Â /g," ")),9,De)]))),256))]))),256))],2)])}var Ve=g(xe,[["render",Le],["__scopeId","data-v-41920343"]]);const Be={data(){return{text:""}},props:{date:Date},methods:S(_({},E(["addToSchedule"])),{save(e){this.text!=""&&(this.addToSchedule({date:this.date,text:this.text}),this.text="",this.$emit("close-form"))}})},Oe={class:"input"},qe={action:""},Pe={key:0,class:"form-date"};function Ae(e,t,o,r,s,n){return c(),d("div",Oe,[a("form",qe,[o.date?(c(),d("div",Pe,i(String(o.date.getDate()).padStart(2,"0"))+" "+i(String(o.date.getMonth()+1).padStart(2,"0"))+" "+i(o.date.getFullYear()),1)):$("",!0),y(a("textarea",{name:"form-text","onUpdate:modelValue":t[0]||(t[0]=l=>s.text=l),class:"form-text"},null,512),[[N,s.text]]),a("button",{class:"form-btn",onClick:t[1]||(t[1]=V(l=>n.save(),["prevent"]))},"Save"),a("button",{onClick:t[2]||(t[2]=V(l=>e.$emit("close-form"),["prevent"]))},"Close")])])}var He=g(Be,[["render",Ae],["__scopeId","data-v-a7de75d8"]]);const je={components:{DatePicker:j,ScheduleInputForm:He,ButtonGlow:B},data(){return{date:null,showCalendar:!1}},computed:_({},M(["getUsername"])),watch:{showCalendar:function(e){e||(this.date=null)}}},Ge={class:"calendar"};function ze(e,t,o,r,s,n){const l=p("DatePicker",!0),f=p("button-glow"),v=p("ScheduleInputForm");return c(),d(w,null,[y(a("div",Ge,[a("div",{class:W(["date-picker-container",{"date-picker-show":s.showCalendar}])},[m(l,{modelValue:s.date,"onUpdate:modelValue":t[0]||(t[0]=u=>s.date=u),class:"date-picker",color:"blue","is-dark":""},null,8,["modelValue"])],2),m(f,{onClick:t[1]||(t[1]=u=>s.showCalendar=!s.showCalendar),text:s.showCalendar?"Close Calendar":"Show Calendar"},null,8,["text"])],512),[[F,e.getUsername!=""]]),m(v,{date:s.date,style:G(s.date?"transform: scale(1)":"transform: scale(0)"),onCloseForm:t[2]||(t[2]=u=>s.date=null)},null,8,["date","style"])],64)}var Ye=g(je,[["render",ze],["__scopeId","data-v-f9549be6"]]);const Ke={name:"Login",data(){return{username:"user",password:"user"}},computed:_({},M(["getUsername"])),methods:S(_({},E(["login","logout"])),{async loginForm(e){e.preventDefault();const t=document.getElementById("username"),o=document.getElementById("password");try{await this.login({username:this.username,password:this.password})}catch(r){t.setCustomValidity(r.request.response),t.reportValidity(),t.setCustomValidity(""),o.setCustomValidity("")}}})},Je=e=>(T("data-v-8e88c40e"),e=e(),U(),e),Qe={class:"login"},Re=Je(()=>a("button",{type:"submit"},"log in",-1)),Xe={class:"user"};function Ze(e,t,o,r,s,n){return c(),d("div",Qe,[y(a("form",{onSubmit:t[2]||(t[2]=(...l)=>n.loginForm&&n.loginForm(...l))},[y(a("input",{type:"text",name:"username",id:"username",required:"","onUpdate:modelValue":t[0]||(t[0]=l=>s.username=l),placeholder:"username"},null,512),[[N,s.username]]),y(a("input",{type:"text",name:"password",id:"password",required:"","onUpdate:modelValue":t[1]||(t[1]=l=>s.password=l),placeholder:"password"},null,512),[[N,s.password]]),Re],544),[[F,e.getUsername===""]]),y(a("div",Xe,[a("p",null,i(e.getUsername),1),a("button",{onClick:t[3]||(t[3]=(...l)=>e.logout&&e.logout(...l))},"Log Out")],512),[[F,e.getUsername!=""]])])}var et=g(Ke,[["render",Ze],["__scopeId","data-v-8e88c40e"]]);const tt={name:"Messages",computed:_({},M(["getMessages"]))},st={class:"message-container"},ot={class:"message"};function at(e,t,o,r,s,n){return c(),d("div",st,[(c(!0),d(w,null,k(e.getMessages,l=>(c(),d("div",ot,i(l.from)+": "+i(l.text),1))),256))])}var nt=g(tt,[["render",at],["__scopeId","data-v-706ce614"]]);const rt={components:{WeatherCard:ye,DatePicker:Ye,Schedule:Ve,Login:et,Messages:nt},methods:_(_({},E(["fetchSchedule","fetckMessagesSocket"])),z(["setUsername"])),created(){this.fetchSchedule(),this.fetckMessagesSocket();const e=localStorage.getItem("x-auth-token"),t=localStorage.getItem("username");e&&t&&(this.setUsername(t),h.defaults.headers.post["x-auth-token"]=e,h.defaults.headers.delete["x-auth-token"]=e,h.defaults.headers.put["x-auth-token"]=e)}},lt={class:"container"},ct={class:"showcase"},dt={class:"datepicker-container"},it={class:"weather-container"},ut=a("div",{class:"welcome"},[a("h1",null,"house web")],-1),ht={class:"schedule-container"};function _t(e,t,o,r,s,n){const l=p("login"),f=p("date-picker"),v=p("WeatherCard"),u=p("Schedule"),I=p("messages");return c(),d("div",lt,[m(l),a("div",ct,[a("div",dt,[m(f)]),a("div",it,[ut,m(v)]),a("div",ht,[m(u)])]),m(I)])}var mt=g(rt,[["render",_t]]);const pt="http://localhost:5000/";var b={host:pt},gt=Y({state:{schedule:{},username:"",messages:null},getters:{getSchedule:e=>e.schedule,getScheduleById:e=>t=>{let o=null;return Object.entries(e.schedule).forEach(([r,s])=>{s.forEach(n=>{n._id===t&&(o=n)})}),o},getUsername:e=>e.username,getMessages:e=>e.messages},actions:{async fetchSchedule({commit:e}){try{const t=await h.get(`${b.host}api/schedule`);e("addSchedule",t.data)}catch(t){console.log(t)}},async addToSchedule({commit:e},t){try{t.date.setHours(0,0,0,0);const o=S(_({},t),{username:this.state.username}),r=await h.post(`${b.host}api/schedule`,o);e("addToSchedule",r.data)}catch(o){console.log("addToSchedule Error -> "+o)}},async editNote({commit:e},t){try{const o=await h.put(`${b.host}api/schedule`,t)}catch(o){console.log("editSchedule Error -> "+o)}},async deleteFromSchedule({commit:e},t){if(confirm("are you shure?"))try{const o=await h.delete(`${b.host}api/schedule/${t}`);e("deleteFromSchedule",t)}catch(o){console.log(`deleteFromSchedule error -> ${o}`)}},async login({commit:e,dispatch:t},o){try{const r=await h.post(`${b.host}api/auth`,o);console.log(`user ${r.data.username} is logged in`);const s=r.headers["x-auth-token"];localStorage.setItem("x-auth-token",s),localStorage.setItem("username",r.data.username),h.defaults.headers.post["x-auth-token"]=s,h.defaults.headers.delete["x-auth-token"]=s,h.defaults.headers.put["x-auth-token"]=s,e("setUsername",r.data.username),t("fetchMessages")}catch(r){if(r.request!=null)throw r;console.log(r)}},logout({commit:e}){e("setUsername",""),e("addMessages",null),localStorage.removeItem("x-auth-token"),delete h.defaults.headers.post["x-auth-token"],delete h.defaults.headers.delete["x-auth-token"]},async fetchMessages({commit:e}){try{let t={headers:{"x-auth-token":localStorage.getItem("x-auth-token")}};const o=await h.get(`${b.host}api/messages`,t);e("addMessages",o.data)}catch(t){console.log(t)}},fetckMessagesSocket({commit:e}){console.log("---fetch socket---"),io(),io.onmessage=function(t){console.log(t)}}},mutations:{addSchedule(e,t){const o=(r,s)=>r.reduce((n,l)=>S(_({},n),{[l[s]]:[...n[l[s]]||[],l]}),{});e.schedule=o(t,"date")},addToSchedule(e,t){Object.keys(e.schedule).includes(t.date)?e.schedule[t.date].push(t):e.schedule[t.date]=[t]},setUsername(e,t){e.username=t},editSchedule(e,t){let o=this.getScheduleById(t.id);o.text=t.tex},deleteFromSchedule(e,t){Object.entries(e.schedule).forEach(([o,r])=>{r.forEach(s=>{s._id===t&&(e.schedule[o].splice(r.indexOf(s),1),e.schedule[o].length===0&&delete e.schedule[o])})})},addMessages(e,t){e.messages=t}}});K(mt).use(gt).mount("#app");
