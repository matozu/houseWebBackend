var Q=Object.defineProperty,R=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var H=(e,t,o)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,i=(e,t)=>{for(var o in t||(t={}))Z.call(t,o)&&H(e,o,t[o]);if(j)for(var o of j(t))ee.call(t,o)&&H(e,o,t[o]);return e},b=(e,t)=>R(e,X(t));import{c,o as d,a as te,b as _,l as se,m as x,d as M,e as n,t as u,F as S,r as k,w as $,v as P,f as p,n as O,g as U,p as q,h as A,i as m,j as D,T as W,k as g,q as E,s as V,u as z,x as G,y as oe,z as L,_ as ne,A as ae}from"./vendor.b80a6bff.js";const re=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function o(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerpolicy&&(l.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?l.credentials="include":s.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(s){if(s.ep)return;s.ep=!0;const l=o(s);fetch(s.href,l)}};re();var f=(e,t)=>{const o=e.__vccOpts||e;for(const[a,s]of t)o[a]=s;return o};const le={},de={class:"close-icon"};function ce(e,t,o,a,s,l){return d(),c("div",de)}var Y=f(le,[["render",ce],["__scopeId","data-v-2eb9cc04"]]);const ue="http://houseweb.herokuapp.com/",ie="http://localhost:5000/";var F={host:ue,host1:ie},C=te({state:{schedule:{},username:"",messages:{},chatUsername:null,showMessages:!1,showUsers:!1,users:{}},getters:{getSchedule:e=>e.schedule,getScheduleById:e=>t=>{let o=null;return Object.entries(e.schedule).forEach(([a,s])=>{s.forEach(l=>{l._id===t&&(o=l)})}),o},getUsername:e=>e.username,getMessages:e=>e.messages,getChatUsername:e=>e.chatUsername,getShowMessages:e=>e.showMessages,users:e=>e.users,showUsers:e=>e.showUsers},actions:{async fetchSchedule({commit:e}){try{const t=await _.get(`${F.host}api/schedule`);e("addSchedule",t.data)}catch(t){console.log(t.message)}},async addToSchedule({commit:e},t){try{t.date.setHours(0,0,0,0);const o=b(i({},t),{username:this.state.username}),a=await _.post(`${F.host}api/schedule`,o);e("addToSchedule",a.data)}catch(o){console.log("addToSchedule Error -> "+o)}},async editNote({commit:e},t){try{const o=await _.put(`${F.host}api/schedule`,t)}catch(o){console.log("editSchedule Error -> "+o)}},async deleteFromSchedule({commit:e},t){if(confirm("are you shure?"))try{const o=await _.delete(`${F.host}api/schedule/${t}`);e("deleteFromSchedule",t)}catch(o){console.log(`deleteFromSchedule error -> ${o}`)}},async login({commit:e,dispatch:t},o){try{const a=await _.post(`${F.host}api/auth`,o);console.log(`user ${a.data.username} is logged in`);const s=a.headers["x-auth-token"];localStorage.setItem("x-auth-token",s),localStorage.setItem("username",a.data.username),_.defaults.headers.post["x-auth-token"]=s,_.defaults.headers.delete["x-auth-token"]=s,_.defaults.headers.put["x-auth-token"]=s,e("setUsername",a.data.username),y.auth.token=s,y.connect()}catch(a){if(a.request!=null)throw console.log("response :"+a.request.response),a;console.log(a)}},logout({commit:e}){e("setUsername",""),e("addMessages",null),e("setShowMessages",!1),e("setChatUsername",null),localStorage.removeItem("x-auth-token"),delete _.defaults.headers.post["x-auth-token"],delete _.defaults.headers.delete["x-auth-token"],delete _.defaults.headers.put["x-auth-token"],y.auth.token=null,y.close()}},mutations:{addSchedule(e,t){const o=(a,s)=>a.reduce((l,r)=>b(i({},l),{[r[s]]:[...l[r[s]]||[],r]}),{});e.schedule=o(t,"date")},addToSchedule(e,t){Object.keys(e.schedule).includes(t.date)?e.schedule[t.date].push(t):e.schedule[t.date]=[t]},setUsername(e,t){e.username=t},editSchedule(e,t){let o=this.getScheduleById(t.id);o.text=t.tex},deleteFromSchedule(e,t){Object.entries(e.schedule).forEach(([o,a])=>{a.forEach(s=>{s._id===t&&(e.schedule[o].splice(a.indexOf(s),1),e.schedule[o].length===0&&delete e.schedule[o])})})},addMessages(e,t){e.messages=t},addMessage(e,t){t.from===e.username?e.messages[t.to]?e.messages[t.to].push(t):e.messages[t.to]=[t]:e.messages[t.from]?e.messages[t.from].push(t):e.messages[t.from]=[t]},setChatUsername(e,t){e.chatUsername=t,e.chatUsername!=null&&(e.showSchedule=!1)},setShowMessages(e,t){e.showMessages=t,e.showMessages==!0&&(e.showSchedule=!1)},addUsers(e,t){e.users=t},updateUserStatus(e,t){try{console.log("update status 4 "+t.username+" : "+t.status);const o=e.users.findIndex(a=>a.username===t.username);e.users[o].isConnected=t.status}catch(o){console.log(o.message)}},setShowUsers(e,t){e.showUsers=t}}});const he=(e,t)=>{const o={};return e.map(a=>{a.from!=t?o[a.from]=[...o[a.from]||[],a]:o[a.to]=[...o[a.to]||[],a]}),o},y=se(F.host,{auth:{token:localStorage.getItem("x-auth-token")}});y.on("connect_error",e=>{console.log(e.message)});y.on("connected",e=>{C.commit("addMessages",he(e.messages,C.state.username)),C.commit("addUsers",e.users)});y.on("message",e=>{C.commit("addMessage",e)});y.on("newUserConnected",e=>{C.commit("updateUserStatus",{username:e,status:!0})});y.on("disconnected",e=>{C.commit("updateUserStatus",{username:e,status:!1}),console.log(e+" disconnected")});const _e={data(){return{messageText:""}},components:{CloseIcon:Y},computed:i({},x(["getMessages","getUsername","getChatUsername"])),methods:b(i({},M(["setChatUsername"])),{sendMessage(){y.emit("postMessage",{to:this.getChatUsername,text:this.messageText}),this.messageText=""}})},me={key:0,class:"chat-container"},pe={class:"chat-header"},ge={class:"chat"},fe={class:"chat-input-form"};function ve(e,t,o,a,s,l){return e.getChatUsername?(d(),c("div",me,[n("div",pe,[n("span",null,u(e.getUsername)+"\xA0\u2190\u2192\xA0"+u(e.getChatUsername),1),n("i",{class:"fa fa-close",onClick:t[0]||(t[0]=r=>e.setChatUsername(null))})]),n("div",ge,[(d(!0),c(S,null,k(e.getMessages[e.getChatUsername],r=>(d(),c("div",{class:O(["chat-message",r.from===e.getUsername?"chat-message-left":"chat-message-right"])},u(r.text),3))),256))]),n("div",fe,[$(n("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=r=>s.messageText=r)},null,512),[[P,s.messageText]]),n("button",{onClick:t[2]||(t[2]=(...r)=>l.sendMessage&&l.sendMessage(...r))},"send")])])):p("",!0)}var we=f(_e,[["render",ve],["__scopeId","data-v-32489fc4"]]);const ye={name:"Forecast",props:{forecast:Array},methods:{calcTemp(e){return Math.round(Number(e)-273.15)},getIconUrl(e){return`http://openweathermap.org/img/w/${e}.png`}}},Se=e=>(q("data-v-0e0d6b16"),e=e(),A(),e),ke={class:"forecast"},$e=U(" \xA0 5 day forecast "),Ue=Se(()=>n("hr",null,null,-1)),be={key:"day.dt"},Ce={key:"day.dt"},Ie={key:"day.dt"},xe=["src"],Me={key:"day.dt"};function Fe(e,t,o,a,s,l){return d(),c("div",ke,[$e,Ue,n("table",null,[n("tr",null,[(d(!0),c(S,null,k(o.forecast,r=>(d(),c("th",be,u(r.day),1))),128))]),n("tr",null,[(d(!0),c(S,null,k(o.forecast,r=>(d(),c("td",Ce,u(l.calcTemp(r.main.temp))+"\xB0 ",1))),128))]),n("tr",null,[(d(!0),c(S,null,k(o.forecast,r=>(d(),c("td",Ie,[n("img",{src:l.getIconUrl(r.weather[0].icon),alt:""},null,8,xe)]))),128))]),n("tr",null,[(d(!0),c(S,null,k(o.forecast,r=>(d(),c("td",Me,u(r.weather[0].main),1))),128))])])])}var Te=f(ye,[["render",Fe],["__scopeId","data-v-0e0d6b16"]]);const De={name:"WeatherCard",components:{Forecast:Te},data(){return{weather:{},showForecast:!1}},methods:{calcTemp(e){return Math.round(Number(e)-273.15)},calcWindSpeed(e){return Math.round(e*3.6*10)/10},getIconUrl(e){return`http://openweathermap.org/img/w/${e}.png`},calcWindDirection(e){var t=Math.floor(e/22.5+.5),o=["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"];return o[t%16]},toggleShowForecast(){this.weather.forecast||this.fetchForecast().catch(e=>console.log(e)),this.showForecast=!this.showForecast},async fetchWeather(){try{const e=await _.get("https://api.openweathermap.org/data/2.5/weather/?q=gudovac&appid=524464013431281f7aabe3e488765d52");this.weather=await e.data}catch(e){console.log(e)}},async fetchForecast(){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=[];try{const a=await(await _.get("https://api.openweathermap.org/data/2.5/forecast/?q=gudovac&appid=524464013431281f7aabe3e488765d52")).data;if(typeof a!="undefined"){for(let s=7;s<=a.list.length;s+=8){let l=new Date(a.list[s].dt_txt);a.list[s].day=e[l.getDay()],t.push(a.list[s])}this.weather.forecast=t}else throw"problem with fetching forecast"}catch(o){console.log(o)}}},created(){this.fetchWeather()}},N=e=>(q("data-v-95b21f6c"),e=e(),A(),e),Ee={key:0,class:"card"},Ne={class:"header-left"},Pe={class:"header-right"},We=["src"],Ve=N(()=>n("div",{style:{clear:"both"}},null,-1)),Le={class:"weather-main"},Be={class:"main-temp"},Oe={class:"main-right"},qe=N(()=>n("br",null,null,-1)),Ae=N(()=>n("br",null,null,-1)),je=N(()=>n("br",null,null,-1)),He=N(()=>n("div",{style:{clear:"both"}},null,-1));function ze(e,t,o,a,s,l){const r=g("forecast");return s.weather.name?(d(),c("div",Ee,[n("div",Ne,[n("b",null,u(s.weather.name),1),U(" , "+u(s.weather.weather[0].description),1)]),n("div",Pe,[n("img",{src:l.getIconUrl(s.weather.weather[0].icon),alt:""},null,8,We)]),Ve,n("div",Le,[n("div",Be,u(l.calcTemp(s.weather.main.temp))+"\xB0",1),n("div",Oe,[U(" Feels Like: "+u(l.calcTemp(s.weather.main.feels_like))+" \xB0C ",1),qe,U(" Pressure:"+u(s.weather.main.pressure)+" hPa ",1),Ae,U(" Humidity: "+u(s.weather.main.humidity)+" % ",1),je,U(" Wind: "+u(l.calcWindSpeed(s.weather.wind.speed))+" km/h, "+u(l.calcWindDirection(s.weather.wind.deg)),1)])]),n("div",{class:"show-forecast-btn",onClick:t[0]||(t[0]=(...v)=>l.toggleShowForecast&&l.toggleShowForecast(...v))},[n("div",{class:O(s.showForecast?"forecast-icon-minus":"forecast-icon")},null,2)]),He,m(W,null,{default:D(()=>[$(m(r,{forecast:s.weather.forecast},null,8,["forecast"]),[[E,s.showForecast]])]),_:1})])):p("",!0)}var Ge=f(De,[["render",ze],["__scopeId","data-v-95b21f6c"]]);const Ye={props:{text:String}},Ke={class:"show-btn"};function Je(e,t,o,a,s,l){return d(),c("div",Ke,u(o.text),1)}var K=f(Ye,[["render",Je],["__scopeId","data-v-7fab9b97"]]);const Qe={data(){return{text:""}},props:{date:Date},methods:b(i({},V(["addToSchedule"])),{save(e){this.text!=""&&(this.addToSchedule({date:this.date,text:this.text}),this.text="",this.$emit("close-form"))}})},Re={class:"input"},Xe={action:""},Ze={key:0,class:"form-date"};function et(e,t,o,a,s,l){return d(),c("div",Re,[n("form",Xe,[o.date?(d(),c("div",Ze,u(String(o.date.getDate()).padStart(2,"0"))+" "+u(String(o.date.getMonth()+1).padStart(2,"0"))+" "+u(o.date.getFullYear()),1)):p("",!0),$(n("textarea",{name:"form-text","onUpdate:modelValue":t[0]||(t[0]=r=>s.text=r),class:"form-text"},null,512),[[P,s.text]]),n("button",{class:"form-btn",onClick:t[1]||(t[1]=z(r=>l.save(),["prevent"]))},"Save"),n("button",{onClick:t[2]||(t[2]=z(r=>e.$emit("close-form"),["prevent"]))},"Close")])])}var J=f(Qe,[["render",et],["__scopeId","data-v-222c3a69"]]);const tt={name:"Schedule",components:{DatePicker:G,ButtonNormal:K,ScheduleInputForm:J},data(){return{date:null,show:!1,showDatePicker:!1,editableId:null,oldText:""}},computed:i({},x(["getSchedule","getUsername","getShowSchedule"])),methods:b(i(i({},V(["deleteFromSchedule","editNote"])),M(["setShowSchedule"])),{editInSchedule(e){const t=document.getElementById(e);t.contentEditable=!0,t.classList.add("note-text-edit"),this.editableId=e,this.oldText=t.innerHTML},save(e){const t=document.getElementById(e),o=t.innerHTML.replace(/\u00a0/g," ");t.contentEditable=!1,t.classList.remove("note-text-edit"),this.editableId=null,this.oldText="";try{this.editNote({id:e,text:o})}catch(a){console.log(a)}},cancel(e){const t=document.getElementById(e);t.innerHTML=this.oldText,t.contentEditable=!1,t.classList.remove("note-text-edit"),this.editableId=null,this.oldText=""}})},st={class:"schedule",id:"schedule"},ot={class:"notes",key:"notes"},nt={class:"day"},at={class:"day-date"},rt={class:"note"},lt={class:"note-header"},dt={class:"note-username"},ct={class:"note-icons"},ut=["onClick"],it=["onClick"],ht=["onClick"],_t=["onClick"],mt=["id"];function pt(e,t,o,a,s,l){const r=g("button-normal"),v=g("DatePicker"),I=g("ScheduleInputForm");return d(),c("div",st,[m(oe,null,{default:D(()=>[e.getUsername?(d(),L(r,{key:"buttonNormal",text:"Pick a Date",onClick:t[0]||(t[0]=w=>s.showDatePicker=!s.showDatePicker)})):p("",!0),s.showDatePicker&&e.getUsername?(d(),L(v,{key:"datePicker",modelValue:s.date,"onUpdate:modelValue":t[1]||(t[1]=w=>s.date=w),color:"blue","is-dark":""},null,8,["modelValue"])):p("",!0),s.date&&e.getUsername?(d(),L(I,{key:"scheduleInputForm",date:s.date,onCloseForm:t[2]||(t[2]=w=>s.date=null)},null,8,["date"])):p("",!0),n("div",ot,[(d(!0),c(S,null,k(e.getSchedule,(w,T)=>(d(),c("div",nt,[n("div",at,u(new Date(T).getDate())+". "+u(new Date(T).getMonth()+1)+". "+u(new Date(T).getFullYear())+". ",1),(d(!0),c(S,null,k(w,h=>(d(),c("div",rt,[n("div",lt,[n("span",dt,u(h.username)+" :",1),n("span",ct,[e.getUsername===h.username&&s.editableId===h._id?(d(),c("i",{key:0,onClick:B=>l.save(h._id),class:"fa fa-save"},null,8,ut)):p("",!0),e.getUsername===h.username&&s.editableId===h._id?(d(),c("i",{key:1,onClick:B=>l.cancel(h._id),class:"fa fa-times"},null,8,it)):p("",!0),e.getUsername===h.username&&s.editableId!=h._id?(d(),c("i",{key:2,onClick:B=>l.editInSchedule(h._id),class:"fa fa-edit"},null,8,ht)):p("",!0),e.getUsername===h.username?(d(),c("i",{key:3,onClick:B=>e.deleteFromSchedule(h._id),class:"fa fa-trash"},null,8,_t)):p("",!0)])]),n("span",{class:"note-text",id:h._id},u(h.text.replace(/ /g," ")),9,mt)]))),256))]))),256))])]),_:1})])}var gt=f(tt,[["render",pt],["__scopeId","data-v-65a8a2ca"]]);const ft={components:{DatePicker:G,ButtonNormal:K,ScheduleInputForm:J},data(){return{date:null,showDatePicker:!1}},computed:i({},x(["getUsername"])),watch:{showDatePicker(e){e||(this.date=null)}}};function vt(e,t,o,a,s,l){const r=g("button-normal"),v=g("DatePicker",!0),I=g("ScheduleInputForm");return d(),c(S,null,[m(r,{text:"Pick a Date",onClick:t[0]||(t[0]=w=>s.showDatePicker=!s.showDatePicker)}),m(W,null,{default:D(()=>[$(m(v,{modelValue:s.date,"onUpdate:modelValue":t[1]||(t[1]=w=>s.date=w),color:"blue","is-dark":""},null,8,["modelValue"]),[[E,s.showDatePicker]])]),_:1}),m(W,null,{default:D(()=>[$(m(I,{date:s.date,onCloseForm:t[2]||(t[2]=w=>s.date=null)},null,8,["date"]),[[E,s.date]])]),_:1})],64)}var wt=f(ft,[["render",vt],["__scopeId","data-v-157f3f38"]]);const yt={name:"Login",data(){return{username:"",password:""}},computed:i({},x(["getUsername"])),methods:b(i(i({},V(["login","logout"])),M(["setShowMessages"])),{async loginForm(e){e.preventDefault();const t=document.getElementById("username"),o=document.getElementById("password");try{await this.login({username:this.username,password:this.password}),this.username="",this.password=""}catch(a){t.setCustomValidity(a.request.response),t.reportValidity(),t.setCustomValidity(""),o.setCustomValidity("")}}})},St=e=>(q("data-v-9527a942"),e=e(),A(),e),kt={class:"login"},$t=St(()=>n("button",{type:"submit"},"log in",-1)),Ut={class:"user"};function bt(e,t,o,a,s,l){return d(),c("div",kt,[$(n("form",{onSubmit:t[2]||(t[2]=(...r)=>l.loginForm&&l.loginForm(...r))},[$(n("input",{type:"text",name:"username",id:"username",required:"","onUpdate:modelValue":t[0]||(t[0]=r=>s.username=r),placeholder:"username"},null,512),[[P,s.username]]),$(n("input",{type:"text",name:"password",id:"password",required:"","onUpdate:modelValue":t[1]||(t[1]=r=>s.password=r),placeholder:"password"},null,512),[[P,s.password]]),$t],544),[[E,e.getUsername===""]]),$(n("div",Ut,[n("p",{onClick:t[3]||(t[3]=r=>e.setShowMessages(!0))},u(e.getUsername),1),n("button",{onClick:t[4]||(t[4]=(...r)=>e.logout&&e.logout(...r))},"Log Out")],512),[[E,e.getUsername!=""]])])}var Ct=f(yt,[["render",bt],["__scopeId","data-v-9527a942"]]);const It={name:"Messages",components:{CloseIcon:Y},data(){return{messageText:""}},computed:b(i({},x(["getMessages","getUsername","getShowMessages"])),{messagesIsEmpty(){return ne.isEmpty(this.getMessages)}}),methods:i({},M(["setChatUsername","setShowMessages","setShowUsers"])),created(){}},xt={key:0,class:"message-container"},Mt={class:"messages-header"},Ft=U(" messages "),Tt=["onClick"],Dt={class:"username"},Et={class:"text"},Nt={key:0};function Pt(e,t,o,a,s,l){return e.getShowMessages?(d(),c("div",xt,[n("div",Mt,[Ft,n("i",{class:"fa fa-close",onClick:t[0]||(t[0]=r=>e.setShowMessages(!1))})]),(d(!0),c(S,null,k(e.getMessages,(r,v)=>(d(),c("div",{class:"message",onClick:I=>e.setChatUsername(v)},[n("span",Dt,[n("b",null,u(v)+":",1)]),n("span",Et,u(r[r.length-1].text),1)],8,Tt))),256)),l.messagesIsEmpty?(d(),c("div",Nt,"no messages")):p("",!0),n("i",{class:"start-chat fa fa-plus",onClick:t[1]||(t[1]=r=>e.setShowUsers(!0))})])):p("",!0)}var Wt=f(It,[["render",Pt],["__scopeId","data-v-0f60b2ec"]]);const Vt={computed:i({},x(["users","getUsername","showUsers"])),methods:i({},M(["setShowUsers","setChatUsername"]))},Lt={key:0,class:"users-container"},Bt={class:"users"},Ot=["onClick"];function qt(e,t,o,a,s,l){return d(),L(W,null,{default:D(()=>[e.getUsername&&e.showUsers?(d(),c("div",Lt,[n("div",Bt,[n("i",{class:"fa fa-close",onClick:t[0]||(t[0]=r=>e.setShowUsers(!1))}),(d(!0),c(S,null,k(e.users,r=>(d(),c("div",{class:O(["user",r.isConnected?"user-online":""]),onClick:v=>e.setChatUsername(r.username)},u(r.username),11,Ot))),256))])])):p("",!0)]),_:1})}var At=f(Vt,[["render",qt],["__scopeId","data-v-36d233d0"]]);const jt={components:{WeatherCard:Ge,DatePicker:wt,Schedule:gt,Login:Ct,Messages:Wt,Chat:we,Users:At},methods:i(i({},V(["fetchSchedule"])),M(["setUsername"])),created(){this.fetchSchedule();const e=localStorage.getItem("x-auth-token"),t=localStorage.getItem("username");e&&t&&(this.setUsername(t),_.defaults.headers.post["x-auth-token"]=e,_.defaults.headers.delete["x-auth-token"]=e,_.defaults.headers.put["x-auth-token"]=e)}},Ht={class:"container"},zt={class:"showcase"},Gt=n("h1",null,"house web",-1),Yt=n("div",null,[n("a",{href:"#schedule"},[n("div",{class:"scroll-to-schedule-icon"})])],-1),Kt=n("div",{class:"footer"},[U(" Copyright \xA9 2022 by mato "),n("br"),U(" All rights reserved ")],-1);function Jt(e,t,o,a,s,l){const r=g("login"),v=g("WeatherCard"),I=g("users"),w=g("messages"),T=g("chat"),h=g("schedule");return d(),c("div",Ht,[m(r),n("div",zt,[Gt,m(v),Yt,m(I)]),m(w),m(T),m(h),Kt])}var Qt=f(jt,[["render",Jt]]);ae(Qt).use(C,y).mount("#app");
